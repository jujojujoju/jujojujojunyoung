<script>

    var queryString = decodeURIComponent(window.location.search.substring(1));
    var company = queryString.split('=')[1];

    var count = 0;
    function percentCounter(callback) {
        count += Math.ceil((100 - count) / 5);

        $('#loading_percent').text(count + '%');

        if (count < 100) {
            setTimeout(function () {
                percentCounter(callback);
            }, Math.floor(Math.random() * 200));

        } else {
            count = 0;
            callback(1);
        }
    }

    $(document).ready(function () {


        $('#loading_text_1').text(company + ' ' + $('#loading_text_1').text());
        $('#loading_text_2').text(company + ' ' + $('#loading_text_2').text());
        $('#loading_text_3').text(company + ' ' + $('#loading_text_3').text());
        $('#loading_text_4').text(company + ' ' + $('#loading_text_4').text());
        $('#loading_text_5').text(company + ' ' + $('#loading_text_5').text());
        $('#loading_text_6').text(company + ' ' + $('#loading_text_6').text());
        $('#loading_text_7').text(company + ' ' + $('#loading_text_7').text());
        $('#loading_text_8').text(company + ' ' + $('#loading_text_8').text());
        $('#loading_text_9').text(company + ' ' + $('#loading_text_9').text());

        percentCounter(function () {
            if(!confirm(company + " 종목 자동 분석을 시작하시겠습니까?")){
                location.href='/';
            }

            $('#loading_text_1').hide();
            $('#loading_text_2').fadeIn();

            percentCounter(function(){
                $('#loading_text_2').hide();
                $('#loading_text_3').fadeIn();

                percentCounter(function(){
                    $('#loading_text_3').hide();
                    $('#loading_text_4').fadeIn();
                    $('#loading_percent').hide();
                    $('#loading_division').text('1/3');
                    $('#loading_division').show();

                    percentCounter(function(){
                        $('#loading_division').hide();
                        $('#loading_percent').show();
                        $('#loading_text_4').hide();
                        $('#loading_text_5').fadeIn();

                        percentCounter(function(){
                            $('#loading_text_5').hide();
                            $('#loading_text_6').fadeIn();

                            percentCounter(function(){
                                $('#loading_text_6').hide();
                                $('#loading_text_7').fadeIn();
                                $('#loading_percent').hide();
                                $('#loading_division').text('2/3');
                                $('#loading_division').show();

                                percentCounter(function(){
                                    $('#loading_division').hide();
                                    $('#loading_percent').show();
                                    $('#loading_text_7').hide();
                                    $('#loading_text_8').fadeIn();

                                    percentCounter(function(){
                                        $('#loading_text_8').hide();
                                        $('#loading_text_9').fadeIn();

                                        $('.spinner').hide();

                                        if(confirm("분석완료! 분석된 자료를 수령하시겠습니까?")){
                                            location.href='/hp';
                                        } else {

                                        }
                                        // 리다이렉트
                                    })
                                })

                            })
                        })

                    })
                })
            })
        });

    })


</script>